(function(g,p,n,q){g.fn.sonar=function(a,b){"boolean"===typeof a&&(b=a,a=q);return g.sonar(this[0],a,b)};var m=n.body,l=function(a,b,f){if(a){m||(m=n.body);var c=a,d=0,e=m.offsetHeight,g=p.innerHeight||n.documentElement.clientHeight||m.clientHeight||0,h=n.documentElement.scrollTop||p.pageYOffset||m.scrollTop||0,l=a.offsetHeight||0;if(!a.sonarElemTop||a.sonarBodyHeight!==e){if(c.offsetParent){do d+=c.offsetTop;while(c=c.offsetParent)}a.sonarElemTop=d;a.sonarBodyHeight=e}b=b===q?0:b;return!(a.sonarElemTop+(f?0:l)<h-b)&&!(a.sonarElemTop+(f?l:0)>h+g+b)}},h={},r=0,u=function(){setTimeout(function(){var a,b,f,c,d,e,k;for(f in h)for(b=h[f],e=0,k=b.length;e<k;e++)c=b[e],a=c.elem,d=l(a,c.px,c.full),("scrollout"===f?!d:d)?c.tr||(a[f]?(g(a).trigger(f),c.tr=1):(b.splice(e,1),e--,k--)):c.tr=0},25)},t=function(a,b){var f=b.px,c=b.full,d=b.evt,e=l(a,f,c),k=0;a[d]=1;if("scrollout"===d?!e:e)setTimeout(function(){g(a).trigger("scrollout"===d?"scrollout":"scrollin")},0),k=1;h[d].push({elem:a,px:f,full:c,tr:k});r||(g(p).bind("scroll",u),r=1)};g.sonar=l;h.scrollin=[];g.event.special.scrollin={add:function(a){a=a.data||{};this.scrollin||t(this,{px:a.distance,full:a.full,evt:"scrollin"})},remove:function(a){this.scrollin=0}};h.scrollout=[];g.event.special.scrollout={add:function(a){a=a.data||{};this.scrollout||t(this,{px:a.distance,full:a.full,evt:"scrollout"})},remove:function(a){this.scrollout=0}}})(jQuery,window,document);
